---
layout: post
title: "Extract cpu profile and memory dump from your Express.je app"
tags: [ express.js, NodeJs, cpu, performance]
published: false
comments: true
---

folowing the same pattern as my previous post. I’m going to show how I cretaed an entrypoint to extract cpu profile log and heap dump using v8-profile.

Inspite of the horrible documentation v8-profile is pretty handy

anither problem that I’ve found was a segfault when trying to geberate tge heap dumps, that I proptly noticed in the issue tracker that it is a comparibility bug related to node 8.x. folowing x’s advice, I replaced the v8-profile by v8-profile-node8 for now.

code

I used that enable_profile because I dont want to let it available on production. Its a good idea to prevent unauthorize access too

after downloading the files, just load them on chrome dev tools. For a memory leak problem, take a look at my orevieous post

caveats:
generating a memory dump uses a lot of memory, so make sure that the process using less than half of the available memory.
the memory dump must have the file extension .heapdump
the cpu profile log must have the the extension .cpuprofile

screenshot of the memory consumption

I also was trying to use the wrong chome dev tools
more screenshot


